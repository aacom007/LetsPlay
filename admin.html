<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Let's Play Admin</title>

    <script src="https://www.gstatic.com/firebasejs/3.6.4/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/3.6.4/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/3.6.4/firebase-database.js"></script>
    <!-- <script src="https://www.gstatic.com/firebasejs/3.6.4/firebase-messaging.js"></script>
    <script src="https://www.gstatic.com/firebasejs/3.6.4/firebase-storage.js"></script> -->

    <script>
      // Initialize Firebase
      var config = {
        apiKey: "AIzaSyA4s5WAv0Zv00VZrQhEXMDImwiWsSpYMBw",
        authDomain: "letsplay-a07f7.firebaseapp.com",
        databaseURL: "https://letsplay-a07f7.firebaseio.com",
        storageBucket: "letsplay-a07f7.appspot.com",
        messagingSenderId: "40702620919"
      };
      firebase.initializeApp(config);
    </script>

    <script type="text/javascript">

      function createGame(){
        var title = document.getElementById("title").value;
        var time = document.getElementById("when").value;
        var venue = document.getElementById("where").value;

        firebase.database().ref('games').push({
          title: title,
          datetime: time,
          venue: venue
        }).then(()=>{
          alert("game created");
        }).catch((error)=>{
          alert("failed - " + error);
        })

      };

      function initApp(){

        firebase.auth().onAuthStateChanged(user => {
          if(user){
            document.getElementById('container').removeAttribute('hidden');
            document.getElementById("submit").addEventListener('click', createGame)
          }
        })

        //sign in to google at the startup
        if(!firebase.auth().currentUser){
          var provider = new firebase.auth.GoogleAuthProvider();
          firebase.auth().signInWithPopup(provider);
        }
      };

      window.onload = function(){
        initApp();
      }
    </script>
  </head>
  <body>
    <h2>Create new Game</h2>
    <div id="container" hidden>
      <label>Game Title</label>
      <input id="title" type="text" name="" value="">
      <br>
      <label>When</label>
      <input id="when" type="text" name="" value="">
      <br>
      <label>Where</label>
      <input id="where" type="text" name="" value="">
      <br>
      <button id="submit" type="button" name="button">Submit</button>
    </div>
  </body>
</html>
